<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <title>街头霸王</title>
</head>

<body>
    <button id="replay"></button>
    <script>
        let currentPlayer = null;
        var Chunli = {
            name: "春丽",
            sex: "女",
            attack: function () {
                console.log(`${this.name}攻击`)
            },
            defense: function () {
                console.log(`${this.name}防御`)
            },
            jump: function () {
                console.log(`${this.name}跳跃`)
            },
            crouch: function () {
                console.log(`${this.name}蹲下`)
            },
        }
        var Ryu = {
            name: "Ryu",
            sex: "男",
            attack: function () {
                console.log("攻击")
            },
            defense: function () {
                console.log("防御")
            },
            jump: function () {
                console.log("跳跃")
            },
            crouch: function () {
                console.log("蹲下")
            },
        }
        
        const commands = {
            "119": "jump", //w
            "115": "crouch", //s
            "97": "defense", //a
            "100": "attack" //d
        }
        currentPlayer = Chunli;
        const commandStack=[];
        document.onkeypress = function (ev) {
            //console.log(ev.keyCode);
            let keyCode = ev.keyCode,
                command =commands[keyCode] ? makeConmand(currentPlayer, commands[keyCode]) : null;
            if (command){command();
                commandStack.push(command);  }
                
        }



        function makeConmand(reciver, state) {
            return function () {
                // console.log(reciver[state]);

                reciver[state]();
            }
        }
        document.getElementById('replay').onclick=function(){
            let command;
            while( command=commandStack.shift()){
                command();
            }
        }
    </script>
</body>

</html>